# ChemFetch Supabase - Development Setup

This document outlines the linting, formatting, and code quality tools configured for this project.

## 🛠️ Development Tools

### Code Quality Tools Configured

- **ESLint**: TypeScript and JavaScript linting
- **Prettier**: Code formatting
- **TypeScript**: Type checking
- **Husky**: Git hooks
- **lint-staged**: Run linters on staged files
- **SQLFluff**: SQL linting and formatting (optional)

## 📦 Installation

Install all development dependencies:

```bash
npm install
```

Set up git hooks:

```bash
npm run prepare
```

## 🚀 Available Scripts

### Linting

```bash
# Run ESLint on all files
npm run lint

# Fix auto-fixable ESLint issues
npm run lint:fix

# Lint SQL files (requires SQLFluff installation)
npm run lint:sql
```

### Formatting

```bash
# Format all files with Prettier
npm run format

# Check if files are formatted correctly
npm run format:check

# Format SQL files (requires SQLFluff installation)
npm run format:sql
```

### Type Checking

```bash
# Run TypeScript compiler for type checking (no output)
npm run type-check
```

### Combined Commands

```bash
# Check everything (types, linting, formatting)
npm run check-all

# Fix everything that can be auto-fixed
npm run fix-all
```

## 🔧 Configuration Files

- **`.eslintrc.js`**: ESLint configuration with TypeScript support
- **`.prettierrc.json`**: Prettier formatting rules
- **`tsconfig.json`**: TypeScript compiler configuration
- **`.husky/pre-commit`**: Git pre-commit hook
- **`package.json`**: Contains lint-staged configuration

## 📋 Code Quality Rules

### TypeScript/JavaScript Rules

- Strict TypeScript checking enabled
- No unused variables (except those prefixed with `_`)
- Prefer `const` over `let`
- No `var` declarations
- Consistent type definitions using `type` instead of `interface`
- Object shorthand notation required
- Template literals preferred over string concatenation

### Formatting Rules

- Single quotes for strings
- Semicolons required
- Trailing commas in ES5-compatible locations
- 2-space indentation
- 80 character line width (120 for SQL)
- Unix line endings (LF)

### Special File Handling

- **Generated files** (`*.types.ts`, `database.types.ts`): Relaxed linting rules
- **SQL files**: Specialized formatting with keyword capitalization
- **Markdown files**: 100 character line width with prose wrapping

## 🔄 Git Workflow

The pre-commit hook automatically:

1. Runs ESLint with auto-fix on staged TypeScript/JavaScript files
2. Runs Prettier on staged files
3. Prevents commits if there are unfixable linting errors

## 🐛 Troubleshooting

### Common Issues

1. **ESLint errors on generated files**: These are automatically ignored via configuration
2. **Prettier conflicts with ESLint**: The `prettier` config in ESLint disables conflicting rules
3. **TypeScript errors**: Run `npm run type-check` to see detailed type errors
4. **Git hooks not working**: Run `npm run prepare` to reinstall Husky hooks

### Manual Fixes

If automatic fixes don't work:

```bash
# Check what's wrong
npm run check-all

# Fix formatting issues
npm run format

# Fix linting issues (some may need manual intervention)
npm run lint:fix
```

## 📁 Project Structure

```
chemfetch-supabase-live/
├── supabase/
│   ├── database.types.ts     # Generated database types
│   ├── config.toml          # Supabase configuration
│   └── migrations/          # SQL migration files
├── .eslintrc.js            # ESLint configuration
├── .prettierrc.json        # Prettier configuration
├── tsconfig.json           # TypeScript configuration
├── package.json            # Dependencies and scripts
└── .husky/                 # Git hooks
```

## 🚀 Optional: SQL Linting

For advanced SQL linting, install SQLFluff:

```bash
pip install sqlfluff
```

Then you can use:

```bash
npm run lint:sql
npm run format:sql
```

## 📝 Notes

- The `database.types.ts` file is generated by Supabase and should not be manually edited
- SQL migration files follow the pattern: `{number}_{description}.sql`
- All configuration files are set up to work together without conflicts
